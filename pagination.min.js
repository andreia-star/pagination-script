(function() {
  var postResults = typeof postPerPage != "undefined" ? postPerPage : 7,
      numOfPages = 2,
      pageOf = ["Page", "of"],
      noPage, currentPage, currentPageNo, postLabel,
      locationUrl = location.href,
      home_page = "/";

  function startPagination(a) {
    var b = "";
    pageNumber = parseInt(numOfPages / 2);
    if (pageNumber == numOfPages - pageNumber) {
      numOfPages = pageNumber * 2 + 1;
    }
    pageStart = currentPageNo - pageNumber;
    if (pageStart < 1) pageStart = 1;
    lastPageNo = parseInt(a / postResults) + 1;
    if (lastPageNo - 1 == a / postResults) lastPageNo--;
    pageEnd = pageStart + numOfPages - 1;
    if (pageEnd > lastPageNo) pageEnd = lastPageNo;

    b += '<span class="page-of">' + pageOf[0] + " " + currentPageNo + " " + pageOf[1] + " " + lastPageNo + "</span>";
    var c = parseInt(currentPageNo) - 1;

    if (currentPageNo > 1) {
      b += currentPage == "page"
        ? '<a class="page-num page-prev" href="#" onclick="getPage(' + c + ');return false"></a>'
        : '<a class="page-num page-prev" href="#" onclick="getLabelPage(' + c + ');return false"></a>';
    }

    for (var d = pageStart; d <= pageEnd; d++) {
      if (currentPageNo == d) {
        b += '<span class="page-num page-active">' + d + "</span>";
      } else {
        b += currentPage == "page"
          ? '<a class="page-num" href="#" onclick="getPage(' + d + ');return false">' + d + "</a>"
          : '<a class="page-num" href="#" onclick="getLabelPage(' + d + ');return false">' + d + "</a>";
      }
    }

    var e = parseInt(currentPageNo) + 1;
    if (currentPageNo < lastPageNo) {
      b += currentPage == "page"
        ? '<a class="page-num page-next" href="#" onclick="getPage(' + e + ');return false"></a>'
        : '<a class="page-num page-next" href="#" onclick="getLabelPage(' + e + ');return false"></a>';
    }

    document.querySelectorAll('[name="pageArea"]').forEach(el => el.innerHTML = b);
  }

  function dataFeed(a) {
    var b = a.feed;
    if (!b || !b.openSearch$totalResults) return;
    var c = parseInt(b.openSearch$totalResults.$t, 10);
    startPagination(c);
  }

  function pageCurrentBlogger() {
    if (locationUrl.indexOf("/search/label/") != -1) {
      postLabel = locationUrl.indexOf("?updated-max") != -1
        ? locationUrl.substring(locationUrl.indexOf("/search/label/") + 14, locationUrl.indexOf("?updated-max"))
        : locationUrl.substring(locationUrl.indexOf("/search/label/") + 14, locationUrl.indexOf("?&max"));
    }

    if (locationUrl.indexOf("?q=") == -1 && locationUrl.indexOf(".html") == -1) {
      if (locationUrl.indexOf("/search/label/") == -1) {
        currentPage = "page";
        currentPageNo = locationUrl.indexOf("#PageNo=") != -1
          ? locationUrl.substring(locationUrl.indexOf("#PageNo=") + 8)
          : 1;
        var s = document.createElement("script");
        s.src = home_page + "feeds/posts/summary?max-results=1&alt=json-in-script&callback=dataFeed";
        document.head.appendChild(s);
      } else {
        currentPage = "label";
        currentPageNo = locationUrl.indexOf("#PageNo=") != -1
          ? locationUrl.substring(locationUrl.indexOf("#PageNo=") + 8)
          : 1;
        var s = document.createElement("script");
        s.src = home_page + "feeds/posts/summary/-/" + postLabel + "?alt=json-in-script&callback=dataFeed&max-results=1";
        document.head.appendChild(s);
      }
    }
  }

  window.getPage = function(a) {
    jsonstart = (a - 1) * postResults;
    noPage = a;
    var s = document.createElement("script");
    s.src = home_page + "feeds/posts/summary?start-index=" + jsonstart + "&max-results=1&alt=json-in-script&callback=findPostDate";
    document.head.appendChild(s);
  };

  window.getLabelPage = function(a) {
    jsonstart = (a - 1) * postResults;
    noPage = a;
    var s = document.createElement("script");
    s.src = home_page + "feeds/posts/summary/-/" + postLabel + "?start-index=" + jsonstart + "&max-results=1&alt=json-in-script&callback=findPostDate";
    document.head.appendChild(s);
  };

  window.findPostDate = function(a) {
    if (!a.feed || !a.feed.entry || a.feed.entry.length === 0) return;

    var post = a.feed.entry[0],
        b = post.published.$t.substring(0, 19) + post.published.$t.substring(23, 29),
        c = encodeURIComponent(b),
        d = currentPage == "page"
          ? "/search?updated-max=" + c + "&max-results=" + postResults + "#PageNo=" + noPage
          : "/search/label/" + postLabel + "?updated-max=" + c + "&max-results=" + postResults + "#PageNo=" + noPage;

    location.replace(d.replace("?m=1", "").replace("&m=1", ""));
  };

  // Aguarda o DOM carregar antes de executar
  window.addEventListener("DOMContentLoaded", pageCurrentBlogger);
})();
//]]>
